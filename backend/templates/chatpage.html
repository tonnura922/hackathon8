{% extends "base.html" %}

{% block content %}
  <h2>Chat with {% if receiver %}{{ receiver.username }}{% else %}No user selected{% endif %}</h2>

  <h3>Select a user to chat with:</h3>
  <ul>
    {% for user in users %}
      <li><a href="{% url 'chat' user.id %}">{{ user.username }}</a></li>
    {% endfor %}
  </ul>
  
  <div id="chat-box">
    {% if messages %}
      {% for chat in messages %}
        <p><strong>{{ chat.sender.username }}:</strong> {{ chat.message }}</p>
      {% endfor %}
    {% else %}
      <p>No messages yet.</p>
    {% endif %}
  </div>

  <form method="post">
    {% csrf_token %}
    {% if receiver %}
      <input type="hidden" name="receiver_id" value="{{ receiver.id }}">
    {% endif %}
    {{ form.as_p }}
    <br>
    <button type="submit">Send</button>
  </form>
{% endblock %}